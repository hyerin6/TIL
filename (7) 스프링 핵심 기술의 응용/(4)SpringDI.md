# 스프링 3.1의 DI      

#### 자바 언어의 변화와 스프링       
스프링이 제공하는 DI의 원리는 변하지 않았지만 코드를 작성할 대 사용하는 자바 언어에서 변화가 있다.    
이 변화가 DI 프레임워크로서 스프링의 사용 방식에도 영향을 줬다. 두 가지 변화를 알아보자.       

- 어노테이션의 메타정보 활용       
첫번째는 자바 코드의 메타 정보를 이용한 프로그래밍 방식이다.   
자바 코드가 실행되는 것이 목적이 아니라 다른 자바 코드에 의해 데이터처럼 취급되기도 한다.          
리플렉션 API 등을 이용해 어떻게 만들어졌는지 살펴보고 그에 따라 동작하는 기능이 점점 많이 사용되고 있다.        
자바 코드의 메타 정보를 데이터를 활용하는 스타일의 프로그래밍 방식에 더 많이 활용한다는 것이다.          

이런 프로그래밍 방식의 절정은 자바 5에서 등장한 어노테이션일 것이다.    
자바 클래스나 인터페이스, 필드, 메소드 등은 그 자체로 실행 가능하고 상속하거나 참조하거나 호출하는 방식 등으로 직접 이용할 수 있다.      

그러나 어노테이션은 다음과 같은 특징을 갖는다.        
  
<details>        
<summary>어노테이션 특징</summary>      
<div markdown="1">       

- 옵션에 따라 컴파일된 클래스에 존재하거나 애플리케이션이 동작할 때 메모리에 로딩되기도 하지만    
자바 코드가 실행되는 데 직접 참여하지 못한다.    

- 인터페이스처럼 오브젝트에 타입을 부여하는 것도 아니고, 그 자체로 상속이나 오버라이딩이 가능하지도 않다.  
 
- 동작하는 코드를 넣을 수도 없고 코드에서 간단히 참조하거나 활용할 수가 없다.    
 
- 복잡한 리플렉션 API를 이용해 어노테이션의 메타정보를 조회하고            
어노테이션 내에 설정된 값을 가져와 참고하는 방법이 전부다.         

- 어노테이션 자체가 클래스의 타입에 영향을 주지도 못하고 일반 코드에서 활용되지도 못해           
일반적인 객체지향 프로그래밍 스타일의 코드나 패턴 등에 적용할 수도 없다.        

</div>    
</details>     


이렇게 안되는 게 많은데 어노테이션을 이용하는 표준 기술과 프레임워크는 빠르게 증가했다.             

어노테이션의 활용이 늘어난 이유는 무엇일까?     
어노테이션은 애플리케이션을 핵심 로직을 담은 자바 코드와 이를 지원하는 IoC 방식의 프레임워크,   
프레임워트가 참조하는 메타정보라는 세 가지로 구성하는 방식에 잘 어울리기 때문일 것이다.   
어노테이션은 프레임워크가 참조하는 **메타정보로 사용**되기에 여러 가지 유리한 점이 많다.      

DI의 기본 원리를 공부하면서 UserDao에 객체지향 프로그래밍의 특징을 적용해보니      

- 핵심 로직 코드인 UserDao, ConnectionMaker, DConnection      
- 핵심 코드가 런타임 시 동적으로 관계를 맺고 동작하도록 만들어주는 DaoFactory        
- DaoFactory를 활용해 핵심 로직 코드가 서로 관계를 맺고 동작하는 모든 과정을 제어하는 클라이언트 UserDaoTest   
ㅂ
위 세가지로 구분된다.       
핵심 로직을 담은 오브젝트가 클라이언트에 의해 생성되고, 관계를 맺고 제어되는 구조다.      
따라서 이때 클라이언트는 IoC 프레임워크라고 볼 수 있고, DaoFactory는 Ioc 프레임워크가 참조하는 일종의 메타정보로서 의미가 있다.      

      
DaoFactory는 초기에 평범한 자바 코드로 작성됐다.          
그런데 UserDao가 한 가지가 아니라 애플리케이션을 구성하는 많은 오브젝트의 관계를 IoC/DI를 이용해서          
프레임워크와 메타정보를 활용하는 방식으로 작성하도록 발전시키려면 DaoFactory와 같은 단순한 자바 코드로 만들어진 관계 설정 책임을 담은 코드는 불편하다.            

그래서 DaoFactory의 내용을 XML로 전환해서 좀 더 간결한 형태로 전환했다.            
어차피 애플리케이션의 로직은 담은 코드에서 사용될 일이 없기 때문에 형태가 어떻든지 상관없다.          
XML로의 전환은 자바 코드를 이용할 때보다 프레임워크가 할 일이 좀 더 많아졌지만   
작성하기 편하고 빌드 과정이 필요 없으며, AOP를 위해 빈 생성과 관게 설정을 재구성하는 경우를 고려하면 자바 코드보다 유리하기 때문에   
스프링 초창기부터 XML이 프레임워크가 사용하는 오브젝트 관계 설정용 DI 메타정보로 적극 활용돼왔다.       

그런데 어노테이션이 등장하면서 상황이 또 달라졌다.      
어노테이션은 XML이나 여타 외부 파일과 달리 자바 코드의 일부로 사용된다.      
코드의 동작에 직접 영향을 주지는 못하지만 메타정보로서 활용되는 데는 XML에 비해 유리한 점이 많다.     

```  
@Special 
public class MyClass {
    ...
}
```   

`@Special`이라는 어노테이션 하나를 클래스 선언 위에 넣었을 뿐인데 이렇게 하는 것만으로도 여러 가지 정보를 추가로 얻을 수 있다.       


    













































