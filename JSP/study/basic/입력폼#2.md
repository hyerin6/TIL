**form02**

## 1. 배경지식   
(1) Integer.parseInt(s);  
```
String s = "123";
int i = Integer.parseInt(s);
```    
문자열 "123"을 정수 123으로 변환할 때, 이 메소드를 사용합니다.  

(2) session.setAttribute("키", 데이터);
session은 웹 브라우저의 개인 사물함에 비유할 수 있다.  
웹 브라우저가 서버에 처음 요청(HTTP request)을 전달하면,   
그 웹브라우저의 개인 사물함이 서버의 메모리에 생성된다.   

로그아웃 버튼을 클릭하거나 웹브라우저에서 아무런 동작 없이 타임 아웃을 하게 되면  
개인 사물함이 서버 메모리에서 제거된다.   

```  
User user = new User();  
session.setAttribute("key1", user);  
```  
session에 아무 객체나 넣을 수 있다.  

```
User u = (User)session.getAttribute("key1");
```  
넣고 꺼낼 때 키 부분이 일치해야 한다.   

(3) 리다이렉트 (redirect)  
리다이렉트는 웹 서버가 웹 브라우저에게 다른 페이지로 이동하라고 응답하는 기능이다.  
예를 들어, 사용자가 로그인에 성공한 후 메인 페이지로 이동하는 사이트가 많은데  
이렇게 특정 페이지를 실행한 후 지정한 페이지로 이동하길 원할 때 리다이렉트 기능을 사용한다.  

**리다이렉트 메타 태그 (redirect meta tag)**  
```
<meta http-equiv="refresh" content="0; url=http://www.google.com/" />
```    
이 태그가 리다이렉트 메타 태그이다.  
웹브라우저에 로드(load)된 웹페이지에 이 리다이렉트 메타 태그가 포함되어 있으면,  
0초 후에 http://www.google.com/ URL로 넘어간다.  

(4) response.sendRedirect("리다이렉트 URL");  
위 메소드에 의해서 리다이렉트 메타 태그가 웹 브라우저에 출력된다.  
리다이텍트 메타 태그에 리다이렉트 URL이 포함된다.  

대부분의 경우 작업이 성공한 경우에만 리다이렉트를 해야 하기 때문에  
작업이 성공적으로 끝난 후 response.sendRedirect(...) 메소드를 호출하여  
리다이렉트 메타 태그를 출력하는 형태로 구현한다.    

리다이렉트 메타 태그를 받은 웹 브라우저는 이 메타 태그에 포함된 리다이렉트 URL을  
즉시 서버에 다시 요청하게 된다.  
-> 리다이렉트를 지시한 jsp 페이지가 있는 경우 웹 브라우저는 실질적으로 요청을 두번하는 것임    

  
<img width="677" alt="2019-02-12 3 31 51" src="https://user-images.githubusercontent.com/33855307/52617115-17e4d180-2ede-11e9-9c1d-a28bc9fa71d6.png">


## 2. 로그인폼 
(1) form02/login1.jsp  
**Q1.** 로그인 버튼을 클릭할 때마다 현재시각이 다르게 표시되는 이유는 무엇인가?  
**A.** 로그인 버튼은 submit(button type="submit") 버튼이기 때문에   
입력폼에 데이터를 입력한 후 submit 버튼을 누르면 다시 login1.jsp 페이지가 요청된다.   
웹 서버는 요청된 페이지를 처음부터 새로 실행하기 때문에 현재시각이 달라진다.  

**Q2.** 사용자 아이디와 비밀번호를 입력하고 로그인 버튼을 클릭하면, 입력한 내용이 사라진다.  
자동 로그인을 체크하고 로그인 버튼을 클릭하면, 체크가 사라진다.  
그 이유는 무엇인가?  
**A.** 아이디와 비밀번호 입력폼에 value값을 지정하지 않았기 때문에 입력폼에 입력했던 내용이 사라진다.  
(로그인 버튼을 누르면 페이지가 새로 실행됨)  
자동 로그인 체크 박스의 checked 속성을 포함하고 있지 않기 때문에 페이지가 재실행되면 체크가 사라진다.   

(2) form02/login2.jsp  
**Q1.** 사용자 아이디와 비밀번호를 입력하고 로그인 버튼을 클릭하면,  
사용자 아이디에는 언제나 "guest" 값이 채워져 있고,  
자동 로그인은 언제나 체크된 상태로 표시된다. 그 이유는 무엇인가?  
**A.** 먼저 자바 코드 부분에서 변수 userid에 “guest” 문자열을 저장해놨다.  
그리고 입력폼의 value값에 userid를 지정해놨기 때문에 페이지가 재실행되어도   
id의 입력폼에 "guest" 값이 채워져 있는 것이다.  
자동 로그인 체크 박스는 checked 속성을 갖고 있기 때문에 항상 체크된 상태도 표시된다.   
  
(2) form02/login3.jsp  
**Q1.** 아무것도 입력하지 말고 로그인 버튼을 클릭하자.  
에러 메시지가 표시된다.   
그 이유는 무엇인가?   
**A.** 자바 코드 부분에서 userid가 null인 경우 즉, 아무것도 입력하지 않았을 때     
에러메시지에 “사용자 아이디를 입력하세요.”를 대입했다.   
그리고 페이지 제일 마지막 부분에 에러메시지가 null이 아니면   
로그인 실패와 에러메시지가 출력된다.   

**Q2.** 사용자 아이디만 입력하고 로그인 버튼을 클릭하자.  
사용자 아이디가 그대로 남아있다. 그 이유는 무엇인가?  
**A.**  

**Q3.** 사용자 아이디와 비밀번호를 입력하고 로그인 버튼을 클릭하자.   
사용자 아이디는 그대로 남아있지만, 비밀번호는 없어진다.  
그 이유는 무엇인가?  
 
**A.** 

사용자 아이디와 비밀번호를 일치하게 입력하고,   
로그인 버튼을 클릭하면 login_success.jsp 페이지로 넘어간다. (redirect 한다.) 
  
login3.jsp 페이지에서 login_success.jsp 페이지로 리다이렉트할 때,   
login3.jsp 페이지에서 생성한 지역 변수들은 서버 메모리에서 전부 제거된다.   
  
  
**login3.jsp 실행절차**  
1) login3.jsp 파일의 GET 방식 실행 요청이, 웹브라우저로부터 서버로 전송된다.  
2) 서버에서 login3.jsp 파일이 실행된다.   
GET 방식 요청이므로, 줄10의 if 문은 false가 된다.  
3) login3.jsp 파일의 실행결과 출력이 웹브라우저에 전송된다.  
4) 웹브라우저창에 로그인 폼이 출력된다.  
5) 사용자가 로그인 정보를 입력하고 submit 버튼을 클릭한다.  
6) login3.jsp 파일의 POST 방식 실행 요청이, 웹브라우저로부터 서버로 전송된다.  
입력폼에 입력된 로그인 정보가 request parameter에 포함되어 서버에 전송된다.  
7) 서버에서 login3.jsp 파일이 실행된다.  
POST 방식 요청이므로, 줄10의 if 문은 true가 된다.  
8) 줄22~23, 이름이 각각 userid, autologin 인 데이터가 session 에 등록된다.  
9) 줄24, login_success.jsp URL로 리다이렉트 하라는 메타 태그가 출력된다.  
10) login3.jsp 파일의 실행을 종료한다. (login3.jsp 에서 생성한 지역 변수들이 메모리에서 제거된다.)  
출력된 리다이렉트 메타 태그가 웹브라우저에 전송된다.  
11) 웹브라우저는 login_success.jsp 파일의 GET 방식 실행 요청을 서버로 전송한다.  
12) 서버에서 login_success.jsp 파일이 실행된다.  
13) 이름이 각각 userid, autologin 인 데이터를 session 에서 꺼낸다.  
14) session 에서 꺼낸 데이터를 출력한다.  
15) 출력된 태그들이 웹브라우저에 전송된다.  
16) 전송된 태그들이 웹브라우저 창에 그려진다.  
