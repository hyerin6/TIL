# 스프링의 IoC   

<br />    
 
## 1. 오브젝트 팩토리를 이용한 스프링 IoC       

### 애플리케이션 컨텍스트와 설정정보     
스프링에서 스프링이 **제어권**을 가지고 직접 만들고 관계를 부여하는 오브젝트를 **빈(bean)**이라고 부른다.     
동시에 스프링 빈은 스프링 컨테이너가 생성과 관계설정, 사용 등을 제어해주는 제어의 역전이 적용된 오브젝트를 가리키는 말이다.      

빈 생성과 관계설정 같은 제어를 담당하는 IoC 오브젝트를 빈 팩토리(Bean Factory)라고 부른다.   
보통 빈 팩토리보다는 좀 더 확장한 애플리케이션 컨텍스트(application context)를 주로 사용한다.   
  
애플리케이션 컨텍스트는 IoC 방식을 따라 만들어진 일종의 빈 팩토리라고 생각하면 된다.     
별도의 정보를 참고해서 빈의 생성, 관계설정 등의 제어작업을 총괄한다.     
그 설정정보를 만드는 방법은 여러가지가 있는데 앞서 만든 오브젝트 팩토리인 DaoFactory도 조금만 손을 보면 설정정보로 사용할 수 있다.     

DaoFactory 자체가 설정정보까지 담고 있는 IoC 엔진이다. **DaoFactory = 설계도**         
설계도라는 게 바로 애플리케이션 컨텍스트와 그 설정정보이다.       


### DaoFactory를 사용하는 애플리케이션 컨텍스트   
DaoFactory를 스프링의 빈 팩토리가 사용할 수 있는 본격적인 설정정보를 만들자.    

스프링이 빈 팩토리를 위한 오브젝트 설정을 담당하는 클래스라고 인식할 수 있도록 `@Configuration` 이라는 어노테이션을 추가한다.   
그리고 오브젝트를 만들어주는 메소드에는 `@Bean` 이라는 어노테이션을 붙여준다.        


**예)**  UserDao() 메소드는 UserDao 타입 오브젝트를 생성하고 초기화해서 돌려주는 것이므로 `@Bean`이 붙는다.   
ConnectionMaker 타입의 오브젝트를 생성해주는 connection() 메소드에도 `@Bean`을 붙여준다.       


이 어노테이션만으로 스프링 프레임워크의 빈 팩토리 또는 애플리케이션 컨텍스트가 IoC 방식의 기능을 제공할 때 사용할 완벽한 설정정보가 된 것이다.   


 
`@Configuration` - 애플이케이션 컨텍스트 또는 빈 팩토리가 사용할 설정정보라는 표시   
`@Bean` - 오브젝트 생성을 담당하는 IoC용 메소드라는 표시   



애플리케이션 컨텍스트는 ApplicationContext 타입의 오브젝트이다.     
ApplicationContext를 구현한 클래스는 여러가지가 있는데 DaoFactory처럼   
`@Configuration`이 붙은 자바 코드를 설정정보로 사용하려면     
AnnotationConfigApplicationContext를 이용하면 된다.     


```  
ApplicationContext context = new AnnotationConfigApplicationContext(DaoFactory.class);  
UserDao dao = context.getBean("userDao", UserDao.class); // userDao() 메소드를 호출해서 그 결과를 가져온다.   
```  


**Q.** UserDao를 가져오는 메소드는 하나뿐인데 왜 굳이 이름을 사용할까?   
**A.** UserDao를 생성하는 방식이나 구성을 다르게 가져가는 메소드를 추가할 수 있기 때문이다.   


<br />      

 
## 2. 애플리케이션 컨텍스트의 동작 방식     

오브젝트 팩토리에 대응되는 것이 스프링 애플리케이션 컨텍스트다.    
스프링에서는 이 애플리케이션 컨텍스트를 IoC 컨테이너라 하기도하고 스프링 컨테이너, 빈 팩토리라고 부르기도 한다.     

**왜 그렇게 부르는걸까?**         
IoC Container는 오브젝트의 생성과 관계설정, 사용, 제거 등의 작업을 대신 해준다하여 붙여진 이름이다.   
이때, IoC Container에 의해 관리되는 오브젝트들은 Bean이라고 부른다.   
IoC Container는 Bean을 저장한다고 하여, BeanFactory라고도 불린다.   

BeanFactory는 하나의 인터페이스이며, Application Context는 BeanFactory의 구현체를 상속받고 있는 인터페이스이다.  
실제로 스프링에서 IoC Container라고 불리는 것은 Application Context의 구현체이다.   



오브젝트 팩토리로 직접 사용했을 때와 비교해서 애플리케이션 컨텍스트를 사용했을 떄 얻을 수 있는 장점은 다음과 같다.   

(1) 클라이언트는 구체적인 팩토리 클래스를 알 필요가 없다.   


(2) 애플리케이션 컨텍스트는 종합 IoC 서비스를 제공해준다.    
오브젝트가 만들어지는 방식, 시점과 전략을 다르게 가져갈 수도 있고,     
이 외에도 다양한 기능을 제공한다.     

(3) 애플리케이션 컨텍스트는 빈을 검색하는 다양한 방법을 제공한다.           
`getBean()` 메소드는 빈의 이름을 이용해 빈을 찾아주는데         
타입만으로 검색하거나 특별한 어노테이션 설정이 되어 있는 빈을 찾을 수도 있다.        



































